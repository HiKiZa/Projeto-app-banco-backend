generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["interactiveTransactions"]
  binaryTargets   = ["native", "darwin", "darwin-arm64", "linux-musl", "debian-openssl-3.0.x", "darwin"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  usu_id       Int        @id @unique @default(autoincrement())
  usu_nome     String
  usu_email    String
  usu_telefone String
  usu_dtNasc   DateTime
  usu_senha    String
  usu_cpf      String     @unique
  contas       Conta?
  endereco     Endereco[]
}

model Endereco {
  end_cep          String
  end_rua          String
  end_num          String
  end_bairro       String
  end_cidade       String
  end_uf           String
  end_complemento  String
  end_id           Int       @id @unique @default(autoincrement())
  usu_id           Int
  end_dtCriado     DateTime  @default(now())
  end_dtModificado DateTime? @updatedAt
  end_ativo        Boolean   @default(true)
  usuario          Usuario   @relation(fields: [usu_id], references: [usu_id])
}

model Conta {
  con_id                     Int             @id @unique @default(autoincrement())
  con_num                    String          @unique
  con_tipo                   String
  con_saldo                  Float
  con_senha                  Int
  usu_id                     Int             @unique
  age_nome                   String
  agencia                    Agencia?        @relation(fields: [age_nome], references: [age_nome])
  usuario                    Usuario         @relation(fields: [usu_id], references: [usu_id])
  transferenciasDestinatario Transferencia[] @relation("Destinatario")
  transferenciasRemetente    Transferencia[] @relation("Remetente")

}

model Agencia {
  age_num  String  
  age_nome String  @id @unique
  Conta    Conta[]
}

model Transferencia {
  trans_id           Int      @id @unique @default(autoincrement())
  trans_remetente    Int
  trans_destinatario Int
  trans_val          Float
  trans_dtTrans      DateTime
  trans_descricao    String
  destinatario       Conta    @relation("Destinatario", fields: [trans_destinatario], references: [con_id])
  remetente          Conta    @relation("Remetente", fields: [trans_remetente], references: [con_id])
}

model Admin {
  adm_id Int @id @unique @default(autoincrement())
  adm_nome String
  adm_acesso Int
}
